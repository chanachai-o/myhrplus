<div class="row">
    <div class="col-2" style="padding: 1px;">
        <h6 class="border-form">
            รหัสพนักงาน
        </h6>
    </div>
    <div class="col-2" style="padding: 1px 10px 1px 10px;">
        <h6 class="border-bottom-form">
            {{masformFinalDetail?.employee.employeeId}}
        </h6>
    </div>
    <div class="col-2" style="padding: 1px;">
        <h6 class="border-form">
            ชื่อ - นามสกุล
        </h6>
    </div>
    <div class="col-2" style="padding: 1px 10px 1px 10px;">
        <h6 class="border-bottom-form">
            {{getText(masformFinalDetail?.employee.thFullName,masformFinalDetail?.employee.engFullName)}}
        </h6>
    </div>
    <div class="col-2" style="padding: 1px;">
        <h6 class="border-form">
            บริษัท
        </h6>
    </div>
    <div class="col-2" style="padding: 1px 10px 1px 10px;">
        <h6 class="border-bottom-form">
            {{token.companyName}}
        </h6>
    </div>
    <div class="col-2" style="padding: 1px;">
        <h6 class="border-form">
            ตำแหน่ง
        </h6>
    </div>
    <div class="col-2" style="padding: 1px 10px 1px 10px;">
        <h6 class="border-bottom-form">
            {{getText(masformFinalDetail?.employee.position.tdesc,masformFinalDetail?.employee.position.edesc)}}
        </h6>
    </div>
    <div class="col-2" style="padding: 1px;">
        <h6 class="border-form">
            แผนก/ส่วน
        </h6>
    </div>
    <div class="col-2" style="padding: 1px 10px 1px 10px;">
        <h6 class="border-bottom-form">
            {{getText(masformFinalDetail?.employee.bu2.tdesc,masformFinalDetail?.employee.bu2.edesc)}}
        </h6>
    </div>
    <div class="col-2" style="padding: 1px;">
        <h6 class="border-form">
            สาย/ฝ่าย
        </h6>
    </div>
    <div class="col-2" style="padding: 1px 10px 1px 10px;">
        <h6 class="border-bottom-form">
            {{getText(masformFinalDetail?.employee.bu1.tdesc,masformFinalDetail?.employee.bu1.edesc)}}
        </h6>
    </div>
    <div class="col-12" style="padding: 1px;">
        <h6 class="border-form text-center">
            Final Evaluation Report (รายงานการประเมินผลงานรายบุคคล)
        </h6>
    </div>
    <div class="row m-0 col-6 p-0">
        <div class="col-4" style="padding: 1px;">
            <h6 class="border-form text-center">
                Topic Evaluation
            </h6>
        </div>
        <div class="col-4" style="padding: 1px;">
            <h6 class="border-form text-center">
                Target
            </h6>
        </div>
        <div class="row m-0 col-4 p-0">
            <div class="col-12" style="padding: 1px;">
                <h6 class="border-form text-center">
                    Percentage Comparison
                </h6>
            </div>
            <div class="row m-0 col-12 p-0">
                <div class="col-6" style="padding: 1px;">
                    <h6 class="border-form text-center">
                        ประเมินตนเอง
                    </h6>
                </div>
                <div class="col-6" style="padding: 1px;">
                    <h6 class="border-form text-center">
                        ผู้บังคับบัญชา
                    </h6>
                </div>
            </div>
        </div>
    </div>
    <div class="row m-0 col-6 p-0">
        <div class="col-4" style="padding: 1px;">
            <h6 class="border-form text-center">
                Level
            </h6>
        </div>
        <div class="col-4" style="padding: 1px;">
            <h6 class="border-form text-center">
                Percentage Rank
            </h6>
        </div>
        <div class="row m-0 col-4 p-0">
            <div class="col-12" style="padding: 1px;">
                <h6 class="border-form text-center">
                    GRADE
                </h6>
            </div>
            <div class="row m-0 col-12 p-0">
                <div class="col-6" style="padding: 1px;">
                    <h6 class="border-form text-center">
                        ประเมินตนเอง
                    </h6>
                </div>
                <div class="col-6" style="padding: 1px;">
                    <h6 class="border-form text-center">
                        ผู้บังคับบัญชา
                    </h6>
                </div>
            </div>
        </div>
    </div>
    <div class="row m-0 col-6 p-0">
        <div class="col-4" style="padding: 1px;">
            <div class="border-form text-center">
                Competency Score
            </div>
        </div>
        <div class="col-4" style="padding: 1px;">
            <div class="border-form text-center">
                {{sumformDetail.competencyScore}}%
            </div>
        </div>
        <div class="row m-0 col-4 p-0">
            <div class="col-6" style="padding: 1px;">
                <div class="border-form text-center">
                    {{fmtStr(((sumformDetail.competencyScore*sumformDetail.selfCompetencyFinalSum)/100)|customRound)}}%
                </div>
            </div>
            <div class="col-6" style="padding: 1px;">
                <div class="border-form text-center">
                    {{fmtStr(((sumformDetail.competencyScore*sumformDetail.bossCompetencyFinalSum)/100)|customRound)}}%
                </div>
            </div>
        </div>
        <div class="col-4" style="padding: 1px;">
            <div class="border-form text-center">
                KPI Score
            </div>
        </div>
        <div class="col-4" style="padding: 1px;">
            <div class="border-form text-center">
                {{sumformDetail.kpiScore}}%
            </div>
        </div>
        <div class="row m-0 col-4 p-0">
            <div class="col-6" style="padding: 1px;">
                <div class="border-form text-center">
                    {{fmtStr(((sumformDetail.kpiScore*sumformDetail.selfKpiScore)/100)|customRound)}}%
                </div>
            </div>
            <div class="col-6" style="padding: 1px;">
                <div class="border-form text-center">
                    {{fmtStr(((sumformDetail.kpiScore*sumformDetail.bossKpiScore)/100)|customRound)}}%
                </div>
            </div>
        </div>
        <div class="col-4" style="padding: 1px;">
            <div class="border-form text-center">
                Final Score
            </div>
        </div>
        <div class="col-4" style="padding: 1px;">
            <div class="border-form text-center">
                {{calFinalScoreTarget()}}%
            </div>
        </div>
        <div class="row m-0 col-4 p-0">
            <div class="col-6" style="padding: 1px;">
                <div class="border-form text-center">
                    {{fmtStr(calFinalScoreSelf()|customRound)}}%
                </div>
            </div>
            <div class="col-6" style="padding: 1px;">
                <div class="border-form text-center">
                    {{fmtStr(calFinalScoreBoss()|customRound)}}%
                </div>
            </div>
        </div>
    </div>
    <div class="row m-0 col-6 p-0">
        <div class="row m-0 col-8 p-0">
            <ng-container *ngFor="let item of sumformDetail.mgradeModelList ; let first = first; let last = last;">
                <div class="col-6" style="padding: 1px;">
                    <div class="border-form text-center">
                        {{item.grade}}
                        ({{getText(item.tdesc,item.edesc)}})
                    </div>
                </div>
                <div class="col-6" style="padding: 1px;">
                    <div class="border-form text-center">
                        <ng-container *ngIf="first">&#8805; </ng-container>
                        <ng-container *ngIf="last">&#8804; </ng-container>
                        <ng-container *ngIf="!last">{{item.grmin}}</ng-container>
                        <ng-container *ngIf="!first&&!last"> - </ng-container>
                        <ng-container *ngIf="!first">{{item.grmax}}</ng-container>
                    </div>
                </div>
            </ng-container>
        </div>
        <div class="row m-0 col-4 p-0">
            <div class="col-6" style="padding: 1px;">
                <div class="border-form text-center">
                    {{gradeSelfCheck()}}
                </div>
            </div>
            <div class="col-6" style="padding: 1px;">
                <div class="border-form text-center">
                    {{gradeBossCheck()}}
                </div>
            </div>
        </div>
    </div>
    <div class="row m-0 ms-3 mt-3 col-12 p-0">
        <div class="col-3" style="padding: 1px;">
            ผลการพิจารณา
        </div>
    </div>
    <div class="row m-0 ms-3 col-12 p-0">
        <div class="col-3" style="padding: 1px;">
            <div class="custom-control custom-radio custom-control-inline">
                <input type="radio" class="custom-control-input" value="1" [(ngModel)]="approvalStatus" id="radio"
                    name="reviewResult" [disabled]="user_level != 'HR_Admin' && user_level != 'HRD_AP'">
                <label class="custom-control-label font-weight-normal" for="radio">
                    {{'ผ่าน'}}
                </label>
            </div>
        </div>
    </div>
    <div class="row m-0 ms-3 col-12 p-0">
        <div class="col-3" style="padding: 1px;">
            <div class="custom-control custom-radio custom-control-inline">
                <input type="radio" class="custom-control-input" value="0" [(ngModel)]="approvalStatus" id="radio0"
                    name="reviewResult" [disabled]="user_level != 'HR_Admin' && user_level != 'HRD_AP'">
                <label class="custom-control-label font-weight-normal" for="radio0">
                    {{'ไม่ผ่าน'}}
                </label>
            </div>
        </div>
    </div>
    <div class="row m-0 ms-3 mb-3 col-12 p-0">
        <div class="col-3" style="padding: 1px;">
            <div class="custom-control custom-radio custom-control-inline">
                <input type="radio" class="custom-control-input" value="2" [(ngModel)]="approvalStatus" id="radio2"
                    name="reviewResult" [disabled]="user_level != 'HR_Admin' && user_level != 'HRD_AP'">
                <label class="custom-control-label font-weight-normal" for="radio2">
                    {{'ทดลองงานต่อ'}}
                </label>
            </div>
        </div>
    </div>
    <div class="col-12" style="padding: 1px;">
        <div class="border-form text-center">
            ผู้ประเมินลงนาม
        </div>
    </div>
    <div class="col-4" style="padding: 1px;">
        <div class="border-form text-center">
            <span style="cursor: pointer;"
                (click)="(user_level != 'HR_Admin' && user_level != 'HRD_AP') || openEmployeeModal(employeeModal,'leader')">Leader
                / Sup. / Section
                Head</span>
            <!-- <button type="button" class="btn btn-info mx-1" (click)="openEmployeeModal(employeeModal,'leader')"
                [disabled]="user_level != 'HR_Admin' && user_level != 'HRD_AP'">
                <i class="fa fa-search"></i>
            </button>
            <button type="button" class="btn btn-danger mx-1" (click)="cancelEmp('leader')"
                [disabled]="user_level != 'HR_Admin' && user_level != 'HRD_AP'">
                <i class="fas fa-times"></i>
            </button> -->
        </div>
    </div>
    <div class="col-4" style="padding: 1px;">
        <div class="border-form text-center">
            <span style="cursor: pointer;"
                (click)="(user_level != 'HR_Admin' && user_level != 'HRD_AP') || openEmployeeModal(employeeModal,'div')">Div.
                / Dept. Manager</span>
            <!-- <button type="button" class="btn btn-info mx-1" (click)="openEmployeeModal(employeeModal,'div')"
                [disabled]="user_level != 'HR_Admin' && user_level != 'HRD_AP'">
                <i class="fa fa-search"></i>
            </button>
            <button type="button" class="btn btn-danger mx-1" (click)="cancelEmp('div')"
                [disabled]="user_level != 'HR_Admin' && user_level != 'HRD_AP'">
                <i class="fas fa-times"></i>
            </button> -->
        </div>
    </div>
    <div class="col-4" style="padding: 1px;">
        <div class="border-form text-center">
            <span style="cursor: pointer;"
                (click)="(user_level != 'HR_Admin' && user_level != 'HRD_AP') || openEmployeeModal(employeeModal,'hr')">HR
                Div./ Dept. Manager /
                MD</span>
            <!-- <button type="button" class="btn btn-info mx-1" (click)="openEmployeeModal(employeeModal,'hr')"
                [disabled]="user_level != 'HR_Admin' && user_level != 'HRD_AP'">
                <i class="fa fa-search"></i>
            </button>
            <button type="button" class="btn btn-danger mx-1" (click)="cancelEmp('hr')"
                [disabled]="user_level != 'HR_Admin' && user_level != 'HRD_AP'">
                <i class="fas fa-times"></i>
            </button> -->
        </div>
    </div>
    <div class="col-4" style="padding: 1px;height: 150px;">
        <div class="border-form text-center row">
            <ng-container *ngIf="leader.signature">
                <div class="col-12">
                    <img [src]="leader.url" alt="Preview" class="img-fluid" style="height: 100px;">
                </div>
            </ng-container>
            <ng-container *ngIf="leader.name.th || leader.name.eng">
                <div class="col-12">
                    ({{getText(leader.name.th,leader.name.eng)}})
                </div>
            </ng-container>
        </div>
    </div>
    <div class="col-4" style="padding: 1px;height: 150px;">
        <div class="border-form text-center row">
            <ng-container *ngIf="div.signature">
                <div class="col-12">
                    <img [src]="div.url" alt="Preview" class="img-fluid" style="height: 100px;">
                </div>
            </ng-container>
            <ng-container *ngIf="div.name.th || div.name.eng">
                <div class="col-12">
                    ({{getText(div.name.th,div.name.eng)}})
                </div>
            </ng-container>
        </div>
    </div>
    <div class="col-4" style="padding: 1px;height: 150px;">
        <div class="border-form text-center row">
            <ng-container *ngIf="hr.signature">
                <div class="col-12">
                    <img [src]="hr.url" alt="Preview" class="img-fluid" style="height: 100px;">
                </div>
            </ng-container>
            <ng-container *ngIf="hr.name.th || hr.name.eng">
                <div class="col-12">
                    ({{getText(hr.name.th,hr.name.eng)}})
                </div>
            </ng-container>
        </div>
    </div>
    <div class="col-4" style="padding: 1px;">
        <div class="border-form text-center">
            Date: <input type="date" class="form-control" [(ngModel)]="leaderDateText"
                [disabled]="user_level != 'HR_Admin' && user_level != 'HRD_AP'">
        </div>
    </div>
    <div class="col-4" style="padding: 1px;">
        <div class="border-form text-center">
            Date: <input type="date" class="form-control" [(ngModel)]="deptManagerDateText"
                [disabled]="user_level != 'HR_Admin' && user_level != 'HRD_AP'">
        </div>
    </div>
    <div class="col-4" style="padding: 1px;">
        <div class="border-form text-center">
            Date: <input type="date" class="form-control" [(ngModel)]="hrDateText"
                [disabled]="user_level != 'HR_Admin' && user_level != 'HRD_AP'">
        </div>
    </div>
    <div class="col-9" style="padding: 1px;">
    </div>
    <div class="col-3" style="padding: 1px;">
        <div class="border-form text-center">
            พนักงานรับทราบ
            <!-- <button type="button" class="btn btn-info mx-1" (click)="openEmployeeModal(employeeModal,'emp')">
                <i class="fa fa-search"></i>
            </button>
            <button type="button" class="btn btn-danger mx-1" (click)="cancelEmp('emp')">
                <i class="fas fa-times"></i>
            </button> -->
        </div>
    </div>
    <div class="col-9" style="padding: 1px;">
    </div>
    <div class="col-3" style="padding: 1px;">
        <div class="border-form text-center row" style="height: 150px;">
            <ng-container *ngIf="emp.signature">
                <div class="col-12">
                    <img [src]="emp.url" alt="Preview" class="img-fluid" style="height: 100px;">
                </div>
            </ng-container>
            <ng-container *ngIf="emp.name.th || emp.name.eng">
                <div class="col-12">
                    ({{getText(emp.name.th,emp.name.eng)}})
                </div>
            </ng-container>
        </div>
    </div>
</div>




<ng-template #employeeModal let-modal>
    <div class="modal-content dialog-height">
        <div class="modal-body"  >
            <div class="card" style="margin-bottom:-15px">
                <div class="card-header bg-myhr">
                    <h4>{{"menu.employee-list" | translate}}</h4>
                </div>
                <div class="card-body pt-0 pt-2">
                    <div class="d-flex mb-1">
                        <input type="text" placeholder="{{'Name-Surname' | translate}}" class="form-control w-25"
                            [(ngModel)]="searchModal">
                    </div>
                    <div class="table-responsive">
                        <table class="table  table-hover table-striped-myhr table-sm  mb-0 no-wrap v-middle ">
                            <thead class="bg-info ">
                                <tr class="text-white font-weight-normal">
                                    <th class="font-weight-normal text-center" scope="col">{{"No."| translate}}</th>
                                    <th class="font-weight-normal text-center" scope="col">{{"UserLevel"| translate}}
                                    </th>
                                    <th class="font-weight-normal text-center" scope="col">{{"Employee ID"| translate}}
                                    </th>
                                    <th class="font-weight-normal text-center" scope="col">{{"Name-Surname"| translate}}
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngIf="!employeeListFilter().length">
                                    <td colSpan="100%" class="font-weight-normal text-center">
                                        {{"No Data Found" | translate}}
                                    </td>
                                </tr>
                                <tr class="cursor-myhr"
                                    *ngFor="let item of employeeListFilter() |slice: (page-1) * pageSize : (page-1) * pageSize + pageSize ; let i=index"
                                    (click)="modal.close(item)">
                                    <th class="align-middle text-center" scope="row">
                                        {{(i+1)+((page-1) * pageSize)}}
                                    </th>
                                    <td class="align-middle text-center">
                                        {{ item.userLevel}}
                                    </td>
                                    <td class="align-middle text-center">
                                        {{ item.employeeId}}
                                    </td>
                                    <td class="align-middle text-center">
                                        {{ getText(item.prefix?.tdesc,item.prefix?.edesc)}}
                                        {{ getText(item.thFullName,item.engFullName)}}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="d-flex justify-content-end p-2">
                        <select class="form-select m-r-5" style="width: auto" [(ngModel)]="pageSize"
                            (ngModelChange)="page=1">
                            <option [ngValue]="10">{{"Items per page" | translate}}: 10</option>
                            <option [ngValue]="50">{{"Items per page" | translate}}: 50</option>
                            <option [ngValue]="100">{{"Items per page" | translate}}: 100</option>
                        </select>
                        <ngb-pagination [collectionSize]="employeeListFilter().length" [(page)]="page"
                            [pageSize]="pageSize" [maxSize]="3" [rotate]="true">
                            <ng-template ngbPaginationPrevious>{{"Prev" | translate}}</ng-template>
                            <ng-template ngbPaginationNext>{{"Next" | translate}}</ng-template>
                        </ngb-pagination>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-danger" (click)="modal.dismiss()">
                {{"Close"| translate}}
            </button>
        </div>
    </div>
</ng-template>
