<div class="card card-hover">
    <div class="card-header bg-myhr">
        <h4>{{"Wage Sheet For Append" | translate}}</h4>
    </div>
    <div class="card-body">
        <!-- Filter Form -->
        <div class="filter-grid">
            <div>
                <label class="form-label">{{"Workarea"| translate}}</label>
                <div class="input-group">
                    <input type="text" class="form-control" [(ngModel)]="selectWorkArea.workareaId" (ngModelChange)="searchWorkAreaId($event)">
                    <div class="input-group-append">
                        <button class="btn me-0 btn-info" type="button" (click)="openBranchModal(branchModal)"><i class="fa fa-search"></i></button>
                    </div>
                </div>
            </div>
            <div>
                <label class="form-label">{{"Workarea Name" | translate}}</label>
                <input readonly type="text" class="form-control" [value]="getName(selectWorkArea.tdesc,selectWorkArea.edesc)">
            </div>
            <div>
                <label class="form-label">{{"month"| translate}}</label>
                <select class="form-select" [(ngModel)]="selectMonth" (ngModelChange)="changeMonth()">
                    <option *ngFor="let item of monthList; let i=index" [ngValue]="item.val">{{item.name| translate}}</option>
                </select>
            </div>
            <div>
                <label class="form-label">{{"year"| translate}}</label>
                <select class="form-select" [(ngModel)]="selectYear" (ngModelChange)="changeMonth()">
                    <option *ngFor="let item of yearList; let i=index" [ngValue]="item">{{item}}</option>
                </select>
            </div>
            <div>
                <label class="form-label">{{"Employee"| translate}}</label>
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="{{'Employee ID'| translate}}" [(ngModel)]="employeeSelect.employeeId" (ngModelChange)="findEmployee()">
                    <div class="input-group-append">
                        <button class="btn me-0 btn-info" type="button" (click)="openEmployeeModal()" [disabled]="employeeList.length == 0"><i class="fa fa-search"></i></button>
                    </div>
                </div>
            </div>
            <div>
                <label class="form-label">{{"Employee Name" | translate}}</label>
                <input readonly type="text" class="form-control" [value]="employeeSelect.getName()">
            </div>
        </div>

        <div class="row mb-3">
            <div class="col-md-6">
                <div class="radio-group justify-content-center">
                    <label class="form-label me-3">{{"date"| translate}}:</label>
                    <div class="form-check">
                        <input type="radio" class="form-check-input" id="customCheck1" value="1" [(ngModel)]="selectDate" (ngModelChange)="changeMonth()">
                        <label class="form-check-label" for="customCheck1">1 - 16</label>
                    </div>
                    <div class="form-check">
                        <input type="radio" class="form-check-input" id="customCheck2" value="16" [(ngModel)]="selectDate" (ngModelChange)="changeMonth()">
                        <label class="form-check-label" for="customCheck2">16 - {{'End of the month'| translate}}</label>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center mb-4">
            <button type="submit" class="btn btn-primary" (click)="searchData()" [disabled]="!selectWorkArea.workareaId">
                <i class="mdi mdi-magnify me-1"></i> {{"systemcode.search" | translate}}
            </button>
        </div>

        <!-- Desktop Table View -->
        <div class="table-responsive d-none d-lg-block">
            <table class="table table-bordered table-sm no-wrap v-middle report-table" id="table">
                <thead class="bg-info text-white">
                    <tr>
                        <th class="sticky-col align-middle text-center" scope="col" rowspan="2">{{"Name-Surname" | translate}}</th>
                        <th class="text-center align-middle" scope="col" rowspan="2">{{'dashboard.position'| translate}}</th>
                        <th class="text-center" scope="col" [colSpan]="numOfDate">ช่วงวันที่ {{selectDate == '1' ? '01' : '16'}} {{getDay(selectMonth,'start') | translate}} {{selectYear}} ถึง {{selectDate == '1' ? '15' : endMonth}} {{getDay(selectMonth,'start') | translate}} {{selectYear}}</th>
                        <th class="text-center align-middle" scope="col" rowspan="2">{{"Work hour"| translate}}</th>
                        <th class="text-center align-middle" scope="col" rowspan="2">{{"Work hour+OT"| translate}}</th>
                        <th class="text-center align-middle" scope="col" rowspan="2">{{"late"| translate}}</th>
                        <th class="text-center align-middle" scope="col" rowspan="2">{{"Early"| translate}}</th>
                        <th class="text-center align-middle" scope="col" rowspan="2">{{"ชั่วโมงจ่าย"| translate}}</th>
                        <th class="text-center" scope="col" colspan="4">{{"OT (ชม)"| translate}}</th>
                        <th class="text-center" scope="col" colspan="6">{{"รายได้เพิ่มเติม (บาท)"| translate}}</th>
                    </tr>
                    <tr>
                        <th class="text-center" scope="col" *ngFor="let item of counter(numOfDate) let i =index">{{selectDate == '1' ?1+i:16+i}}</th>
                        <th class="text-center" scope="col">1</th>
                        <th class="text-center" scope="col">1.5</th>
                        <th class="text-center" scope="col">2</th>
                        <th class="text-center" scope="col">3</th>
                        <th class="text-center" scope="col">Shift</th>
                        <th class="text-center" scope="col">WOW</th>
                        <th class="text-center" scope="col">Rider</th>
                        <th class="text-center" scope="col">Leaflet</th>
                        <th class="text-center" scope="col">เบี้ยเลี้ยง</th>
                        <th class="text-center" scope="col">High Cost</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngIf="loading || timecurrentList.length === 0">
                        <td colspan="100" class="text-center py-3">{{"No Data Found" | translate}}</td>
                    </tr>
                    <tr *ngFor="let item of timecurrentList">
                        <td class="sticky-col">{{item.employee?item.employee.employeeId:'-'}} : {{item.employee?getName(item.employee.thFullName,item.employee.engFullName):'-'}}</td>
                        <td>{{getName(item.ttimeCurrentSum.empPosition.tdesc,item.ttimeCurrentSum.empPosition.edesc)}}</td>
                        <td class="text-center" [ngStyle]="{'background-color':statusColor(time.acApprove,time.rgmApprove)}" *ngFor="let time of item.ttimeCurrentSum.ttimeCurrentList; let l = index">{{dataCheck(time.hourS)}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.sumHour?item.ttimeCurrentSum.sumHour.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.sumHourAndOt?item.ttimeCurrentSum.sumHourAndOt.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.sumLt?item.ttimeCurrentSum.sumLt.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.sumMlv?item.ttimeCurrentSum.sumMlv.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.hourPay?item.ttimeCurrentSum.hourPay.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.ot1?item.ttimeCurrentSum.ot1.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.ot15?item.ttimeCurrentSum.ot15.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.ot2?item.ttimeCurrentSum.ot2.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.ot3?item.ttimeCurrentSum.ot3.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.shift?item.ttimeCurrentSum.shift.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.wow?item.ttimeCurrentSum.wow.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.rider?item.ttimeCurrentSum.rider.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.leaflet?item.ttimeCurrentSum.leaflet.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.allowance?item.ttimeCurrentSum.allowance.toFixed(2):'0'}}</td>
                        <td class="text-center">{{item.ttimeCurrentSum.highCost?item.ttimeCurrentSum.highCost.toFixed(2):'0'}}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Mobile Card View -->
        <div class="d-lg-none">
            <div *ngIf="loading || timecurrentList.length === 0" class="text-center py-3 text-muted">{{"No Data Found" | translate}}</div>
            <div *ngFor="let item of timecurrentList" class="wage-card-mobile">
                <div class="card-header">
                    <span>{{item.employee?getName(item.employee.thFullName,item.employee.engFullName):'-'}}</span>
                    <span class="badge bg-light text-dark">{{item.employee?item.employee.employeeId:'-'}}</span>
                </div>
                <div class="card-body">
                    <div class="info-grid">
                        <div class="info-item"><span>{{"Work hour"| translate}}</span><strong>{{item.ttimeCurrentSum.sumHour?item.ttimeCurrentSum.sumHour.toFixed(2):'0'}}</strong></div>
                        <div class="info-item"><span>{{"Work hour+OT"| translate}}</span><strong>{{item.ttimeCurrentSum.sumHourAndOt?item.ttimeCurrentSum.sumHourAndOt.toFixed(2):'0'}}</strong></div>
                        <div class="info-item"><span>{{"late"| translate}}</span><strong>{{item.ttimeCurrentSum.sumLt?item.ttimeCurrentSum.sumLt.toFixed(2):'0'}}</strong></div>
                        <div class="info-item"><span>{{"Early"| translate}}</span><strong>{{item.ttimeCurrentSum.sumMlv?item.ttimeCurrentSum.sumMlv.toFixed(2):'0'}}</strong></div>
                        <div class="info-item"><span>{{"ชั่วโมงจ่าย"| translate}}</span><strong>{{item.ttimeCurrentSum.hourPay?item.ttimeCurrentSum.hourPay.toFixed(2):'0'}}</strong></div>
                    </div>
                    <div class="daily-hours-grid">
                        <div class="daily-header">{{"Daily Hours" | translate}}</div>
                        <div class="hours-list">
                            <div class="day-item" *ngFor="let time of item.ttimeCurrentSum.ttimeCurrentList; let l = index">
                                <div class="day-number">{{selectDate == '1' ? 1+l : 16+l}}</div>
                                <div class="day-hours" [ngStyle]="{'background-color':statusColor(time.acApprove,time.rgmApprove)}">{{dataCheck(time.hourS)}}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center mt-3">
            <button type="submit" class="btn btn-success" (click)="exportexcel()" [disabled]="timecurrentList.length == 0">
                <i class="mdi mdi-file-excel me-1"></i> {{"Export Excel" | translate}}
            </button>
        </div>

        <!-- Legend and Pagination -->
        <div class="d-flex flex-wrap justify-content-between align-items-center mt-3">
            <div class="legend-group d-flex flex-wrap gap-2">
                <span class="badge" style="background-color:#e4b928;">Part time</span>
                <span class="badge" style="background-color:#30e428;">Full time</span>
                <span class="badge" style="background-color:#eafc8f; color: #000;">AC Approver</span>
                <span class="badge" style="background-color:#b8e2ec; color: #000;">RGM Approver</span>
                <span class="badge" style="background-color:#c7b191;">No Approve</span>
                <span class="badge border" style="background-color:#f4f4f4; color: #000;">No Plan</span>
            </div>
            <div class="d-flex align-items-center">
                <select class="form-select me-2" style="width: auto" [(ngModel)]="pageSize">
                  <option [ngValue]="10">{{"Items per page"| translate}}: 10</option>
                  <option [ngValue]="50">{{"Items per page"| translate}}: 50</option>
                  <option [ngValue]="100">{{"Items per page"| translate}}: 100</option>
                </select>
                <ngb-pagination [collectionSize]="collectionSize" [(page)]="page" [pageSize]="pageSize"></ngb-pagination>
            </div>
        </div>
    </div>
</div>

<!-- Modals remain unchanged -->
<ng-template #branchModal let-modal>
    <div class="modal-body" [perfectScrollbar]>
        <div class="card" style="margin-bottom:-15px">
            <div class="card-header bg-myhr">
                <h4>{{"Working Area Table" | translate}}</h4>
            </div>
            <div class="card-body pt-0 pt-2">
                <div class="d-flex col-5 mb-1 p-0">
                    <input type="text"
                        placeholder="{{'systemcode.search' | translate}} {{'Working Area ID' | translate}}{{' / '}}{{'Working Area Name' | translate}}"[ngModel]="searchModal" (ngModelChange)="searchFilter('workarea',$event)"
                        class="form-control">
                </div>
                <div class="table-responsive">
                    <table class="table  table-hover table-striped-myhr table-sm  mb-0 no-wrap v-middle ">
                        <thead class="bg-info ">
                            <tr class="text-white font-weight-normal">
                                <th class="font-weight-normal text-center" scope="col">{{"Working Area ID"| translate}}
                                </th>
                                <th class="font-weight-normal text-center" scope="col">{{"Working Area Name (Thai)"|
                                    translate}}</th>
                                <th class="font-weight-normal text-center" scope="col">{{"Working Area Name (Eng.)"|
                                    translate}}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngIf="workareaListShow.length == 0">
                                <td colspan="100%" class="font-weight-normal text-center">
                                    {{"No Data Found" | translate}}
                                </td>
                            </tr>
                        </tbody>
                        <tbody>
                            <tr class="cursor-myhr"
                            *ngFor="let item of workareaListShow | slice: (pageModal-1) * pageSizeModal : ((pageModal-1) * pageSizeModal) + pageSizeModal; let i=index"
                            (click)="slectWorkArea(item);modal.close('Close click')">
                            <td class="font-weight-normal text-center">
                                {{item.workareaId}}
                            </td>
                            <td class="font-weight-normal">
                                {{item.tdesc}}
                            </td>
                            <td class="font-weight-normal">
                                {{item.edesc}}
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="d-flex justify-content-end p-2">
                    <select class="form-select m-r-5" style="width: auto" [(ngModel)]="pageSizeModal"
                        (ngModelChange)="page=1">
                        <option [ngValue]="10">{{"Items per page" | translate}}: 10</option>
                        <option [ngValue]="50">{{"Items per page" | translate}}: 50</option>
                        <option [ngValue]="100">{{"Items per page" | translate}}: 100</option>
                    </select>
                    <ngb-pagination [collectionSize]="workareaListShow.length" [(page)]="pageModal" [pageSize]="pageSizeModal"
                        [maxSize]="3" [rotate]="true">
                        <ng-template ngbPaginationPrevious>{{"Prev" | translate}}</ng-template>
                        <ng-template ngbPaginationNext>{{"Next" | translate}}</ng-template>
                    </ngb-pagination>
                </div>
            </div>
        </div>

    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-danger" (click)="modal.dismiss()">{{"Close"| translate}}</button>
    </div>
</ng-template>
<ng-template #alertModal let-modal> ... </ng-template>