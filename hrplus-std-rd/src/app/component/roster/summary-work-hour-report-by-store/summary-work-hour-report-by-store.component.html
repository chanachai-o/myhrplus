<div class="card card-hover">
    <div class="card-header bg-myhr">
        <h4>{{"Summary Work Hour Report Workarea" | translate}}</h4>
    </div>
    <div class="card-body">
        <div class="row">
            <div
                class="col-3 form-group justify-content-center font-weight-bold text-center control-label col-form-label font-14">
                {{"Store Branch"| translate}}
            </div>
            <div class="col-3 form-group justify-content-center">
                <div class="input-group">
                    <input type="text" class="form-control" [(ngModel)]="selectWorkArea.workareaId" (ngModelChange)="searchWorkAreaId($event)">
                    <div class="input-group-append">
                        <button class="btn me-0 btn-info" type="button" (click)="openBranchModal(branchModal)">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-3 form-group justify-content-center align-items-center">
                <input readonly type="text" class="form-control" [value]="getName(selectWorkArea.tdesc,selectWorkArea.edesc)">
            </div>
        </div>
        <div class="row">
            <div
                class="col-3 form-group justify-content-center font-weight-bold text-center control-label col-form-label font-14">
                {{"month"| translate}} - {{"year"| translate}}
            </div>
            <div class="col-3  form-group justify-content-center">
                <select class="form-control" [(ngModel)]="selectMonth" (ngModelChange)="changeMonth()">
                    <option *ngFor="let item of monthList; let i=index" [ngValue]="item.val">
                        {{item.name| translate}}
                    </option>
                </select>
            </div>
            <div class="col-3  form-group justify-content-center">
                <select class="form-control" [(ngModel)]="selectYear" (ngModelChange)="changeMonth()">
                    <option *ngFor="let item of  yearList; let i=index" [ngValue]="item">
                        {{item}}
                    </option>
                </select>
            </div>
        </div>
        <div class="row">
            <div
                class="col-3  form-group justify-content-center font-weight-bold text-center control-label col-form-label font-14">
                {{"Type Employee"| translate}}
            </div>
            <div class="col-3  form-group justify-content-center">
                <select class="form-control" [(ngModel)]="selcetEmpTypeList" (ngModelChange)="changeMonth()">
                    <option *ngFor="let item of empTypeList; let i=index" [ngValue]="item">
                        {{item.getTypeDesc()}}
                    </option>
                </select>
            </div>
        </div>
        <div class="row">
            <div class="d-flex col-12 form-group justify-content-center align-items-center">
                <button type="button" class="btn btn-info" (click)="searchData()" [disabled]="!selectWorkArea.workareaId">
                    {{"Search"| translate}}
                </button>
            </div>
        </div>
        <div class="row m-0">
            <div class="table-responsive form-group">
                <div class="wrapper">
                    <!-- <cdk-virtual-scroll-viewport > -->
                        <table class="table table-bordered table-sm   no-wrap v-middle "  id="table">
                            <thead class="bg-info ">
                                <tr class="text-white font-weight-normal">
                                    <th class="font-weight-normal width-table sticky-col-th first-col align-middle text-center"
                                        scope="col" rowspan="2">
                                        {{"Name-Surname" | translate}}
                                    </th>
                                    <th class="font-weight-normal width-table text-center align-middle" scope="col"
                                        rowspan="2">
                                        {{'dashboard.position'| translate}}
                                    </th>
                                    <th class="font-weight-normal width-table text-center align-middle" scope="col"
                                        rowspan="2">
                                        ยอดชม.ทำงาน ปกติย้อนหลัง
                                    </th>
                                    <th class="font-weight-normal width-table text-center" scope="col" [colSpan]="getEndOfMonth">
                                        ช่วงวันที่ 1 {{getDay(selectMonth) | translate}} {{selectYear}} ถึง {{getEndOfMonth}} {{getDay(selectMonth) | translate}} {{selectYear}}
                                    </th>
                                    <th class="font-weight-normal width-table text-center align-middle" scope="col"
                                        rowspan="2">
                                        {{"จำนวนชม.ปกติ"| translate}}
                                    </th>
                                    <th class="font-weight-normal width-table text-center" scope="col" colspan="2">
                                        {{"OT (ชม)"| translate}}
                                    </th>
                                    <th class="font-weight-normal width-table text-center  align-middle" scope="col" rowspan="2">
                                        {{"ค่าทำงานในวันหยุด"| translate}}
                                    </th>
                                    <th class="font-weight-normal width-table text-center  align-middle" scope="col" rowspan="2">
                                        {{"ค่ากะ"| translate}}
                                    </th>
                                    <th class="font-weight-normal width-table text-center  align-middle" scope="col" rowspan="2">
                                        {{"ค่าแจกใบปลิว"| translate}}
                                    </th>
                                    <th class="font-weight-normal width-table text-center  align-middle" scope="col" rowspan="2">
                                        {{"ค่า wow/ค่าเที่ยว"| translate}}
                                    </th>
                                </tr>
                                <tr class="text-white font-weight-normal">
                                    <th class="font-weight-normal width-table text-center" scope="col" *ngFor="let item of counter(getEndOfMonth) ; let i = index">{{1+i}}</th>
                                    <th class="font-weight-normal width-table text-center" scope="col">1.5</th>
                                    <th class="font-weight-normal width-table text-center" scope="col">3</th>
                                </tr>
                            </thead>
                            <tbody *ngIf="loading">
                                <tr>
                                    <td colspan="100" class="font-weight-normal text-center">
                                        {{"No Data Found" | translate}}
                                    </td>
                                </tr>
                            </tbody>
                            <tbody *ngIf="!loading">
                                <tr *ngFor="let item of timecurrentList; let i = index">
                                    <td class="align-middle sticky-col first-col bg-white " [ngStyle]="{'background-color': statusColor(item.ttimeCurrentSum.empEvery)}"  >{{item.employee?item.employee.employeeId:'-'}} : {{item.employee?getName(item.employee.thFullName,item.employee.engFullName):'-'}}</td>
                                    <td class="align-middle ">{{getName(item.ttimeCurrentSum.empPosition.tdesc,item.ttimeCurrentSum.empPosition.edesc)}}</td>
                                    <td class="align-middle text-center">{{item.ttimeCurrentSum.sumNormalHoursBackwards?item.ttimeCurrentSum.sumNormalHoursBackwards.toFixed(2):'0'}}</td>
                                    <td class="align-middle text-center" *ngFor="let time of item.ttimeCurrentSum.ttimeCurrentList; let l = index">{{dataCheck(time.hourS)}}</td>
                                    <td class="align-middle text-center">{{item.ttimeCurrentSum.sumHourS?item.ttimeCurrentSum.sumHourS.toFixed(2):'0'}}</td>
                                    <td class="align-middle text-center">{{item.ttimeCurrentSum.ot15?item.ttimeCurrentSum.ot15.toFixed(2):'0'}}</td>
                                    <td class="align-middle text-center">{{item.ttimeCurrentSum.ot3?item.ttimeCurrentSum.ot3.toFixed(2):'0'}}</td>
                                    <td class="align-middle text-center">{{item.ttimeCurrentSum.sumHolidayWorkPay?item.ttimeCurrentSum.sumHolidayWorkPay.toFixed(2):'0'}}</td>
                                    <td class="align-middle text-center">{{item.ttimeCurrentSum.shift?item.ttimeCurrentSum.shift.toFixed(2):'0'}}</td>
                                    <td class="align-middle text-center">{{item.ttimeCurrentSum.leaflet?item.ttimeCurrentSum.leaflet.toFixed(2):'0'}}</td>
                                    <td class="align-middle text-center">{{item.ttimeCurrentSum.wow?item.ttimeCurrentSum.wow.toFixed(2):'0'}}</td>
                                </tr>
                                <!-- <tr>
                                <td class="align-middle sticky-col first-col table-info text-center text-dark" >{{'system.total' | translate}}</td>
                                <td class="align-middle text-center text-dark table-info">{{timecurrentList.length?timecurrentList.length:'0'}}</td>
                                <td class="align-middle text-center text-dark table-info" *ngFor="let item of counter(sumDate); let i = index" id="sumVal{{i+1}}"></td>
                                <td class="align-middle text-center text-dark table-info" *ngFor="let item of counter(15); let i = index" id="sumVal{{sumDate+i+1}}"></td>
                                </tr> -->
                            
                            </tbody>
                        </table>
                    <!-- </cdk-virtual-scroll-viewport> -->
                </div>
            </div>
        </div>
        <div class="row">
            <div class="d-flex col-12 form-group justify-content-center align-items-center">
                <button type="submit" class="btn btn-info waves-effect waves-light" [disabled]="timecurrentList.length == 0" (click)="exportexcel()">
                    {{"Export Excel" | translate}}
                </button>
            </div>
        </div>
        <div class="row">
            <div class="d-flex col-12 justify-content-end p-2">
                <div class="p-2 bd-highlight">
                    <span class="badge badge-light rounded-pill bg-danger text-white"
                        style="padding:2.5px 10px 2.5px 10px;">
                        <p class="mb-0 me-1 text-dark font-weight-bold font-14">  ยังไม่ได้เงิน
                        </p>
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>

<ng-template #branchModal let-modal>
    <div class="modal-body" [perfectScrollbar]>
        <div class="card" style="margin-bottom:-15px">
            <div class="card-header bg-myhr">
                <h4>{{"Working Area Table" | translate}}</h4>
            </div>
            <div class="card-body pt-0 pt-2">
                <div class="d-flex col-5 mb-1 p-0">
                    <input type="text"
                        placeholder="{{'systemcode.search' | translate}} {{'Working Area ID' | translate}}{{' / '}}{{'Working Area Name' | translate}}"[ngModel]="searchModal" (ngModelChange)="searchFilter('workarea',$event)"
                        class="form-control">
                </div>
                <div class="table-responsive">
                    <table class="table  table-hover table-striped-myhr table-sm  mb-0 no-wrap v-middle " >
                        <thead class="bg-info ">
                            <tr class="text-white font-weight-normal">
                                <th class="font-weight-normal text-center" scope="col">{{"Working Area ID"| translate}}
                                </th>
                                <th class="font-weight-normal text-center" scope="col">{{"Working Area Name (Thai)"|
                                    translate}}</th>
                                <th class="font-weight-normal text-center" scope="col">{{"Working Area Name (Eng.)"|
                                    translate}}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngIf="workareaListShow.length == 0">
                                <td colspan="100%" class="font-weight-normal text-center">
                                    {{"No Data Found" | translate}}
                                </td>
                            </tr>
                        </tbody>
                        <tbody>
                            <tr class="cursor-myhr"
                            *ngFor="let item of workareaListShow | slice: (pageModal-1) * pageSizeModal : ((pageModal-1) * pageSizeModal) + pageSizeModal; let i=index"
                            (click)="slectWorkArea(item);modal.close('Close click')">
                            <td class="font-weight-normal text-center">
                                {{item.workareaId}}
                            </td>
                            <td class="font-weight-normal">
                                {{item.tdesc}}
                            </td>
                            <td class="font-weight-normal">
                                {{item.edesc}}
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="d-flex justify-content-end p-2">
                    <select class="form-select m-r-5" style="width: auto" [(ngModel)]="pageSizeModal"
                        (ngModelChange)="page=1">
                        <option [ngValue]="10">{{"Items per page" | translate}}: 10</option>
                        <option [ngValue]="50">{{"Items per page" | translate}}: 50</option>
                        <option [ngValue]="100">{{"Items per page" | translate}}: 100</option>
                    </select>
                    <ngb-pagination [collectionSize]="workareaListShow.length" [(page)]="pageModal" [pageSize]="pageSizeModal"
                        [maxSize]="3" [rotate]="true">
                        <ng-template ngbPaginationPrevious>{{"Prev" | translate}}</ng-template>
                        <ng-template ngbPaginationNext>{{"Next" | translate}}</ng-template>
                    </ngb-pagination>
                </div>
            </div>
        </div>

    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-danger" (click)="modal.dismiss()">
            {{"Close"| translate}}
        </button>
    </div>
</ng-template>
