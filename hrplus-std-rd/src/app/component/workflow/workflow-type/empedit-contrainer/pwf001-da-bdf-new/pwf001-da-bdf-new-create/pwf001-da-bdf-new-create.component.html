<div class="row">
  <!-- ส่งถึง -->
  <div class="col-12">
    <app-workflow-sendto (employeeCCId)="employeeCCId=$event" [wfid]="wfid" [cardName]="'pwf001.request.for.certification.center'" [menuPage]="'PWF001_DA_BDF_NEW'"></app-workflow-sendto>
  </div>
  <!-- ปิดส่งถึง -->
  <!-- ข้อมูลพนักงาน -->
  <div class="col-12">
    <app-workflow-emp-information [createBy]="'center'"
      (changeEmpInformation)="empInformation=$event"></app-workflow-emp-information>
  </div>
  <!-- รายละเอียดการขอหนังสือรับรอง -->
  <div class="col-12">
    <div class="card mb-0">
      <div class="card-header bg-myhr">
        <h6 class="card-title">{{"Detail" | translate }}</h6>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-sm-8 col-md-6 col-lg-4  b-r">
            <div class="form-group">
              <small class="text-muted ellipsis-myhr">
                {{"pwf001.certificate.type"| translate }}
              </small>
              <div class="input-group mb-3">
                <input type="text" class="form-control" readonly aria-describedby="basic-addon1"
                  value="{{translateService.currentLang=='th'?certificateTemplateSelect.tdesc:certificateTemplateSelect.edesc}}">
                <div class="input-group-append">
                  <button class="btn me-0 btn-info" type="button" (click)="openCertificateModal(certificateModal)">
                    <i class="fa fa-search"></i></button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row ">
          <div class="col-4 col-sm-3 col-md-2 col-lg-2 align-self-center ">
            <div class="custom-checkbox ms-4">
              <input type="checkbox" class="custom-control-input" id="Check1" [(ngModel)]="thaiCheckbox"
                (change)="!thaiCheckbox?thaiNum=0:thaiNum=1">
              <label class="custom-control-label" for="Check1">{{"systemcode.thai" | translate }}</label>
            </div>
          </div>
          <div class="col-4 col-sm-3 col-md-2 col-lg-2">
            <input [(ngModel)]="thaiNum" type="number" min="1" max="30" class="form-control " [disabled]="!thaiCheckbox"
              (change)="!thaiNum?thaiNum=1:(thaiNum>30?thaiNum=30:thaiNum)">
          </div>
          <div class="col-2 col-sm-2 col-md-2 col-lg-1">
            <label class=" control-label col-form-label">{{"pwf001.copy" | translate}}</label>
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-4 col-sm-3 col-md-2 col-lg-2 align-self-center">
            <div class="custom-checkbox ms-4">
              <input type="checkbox" class="custom-control-input" id="Check2" [(ngModel)]="engCheckbox"
                (change)="!engCheckbox?engNum=0:engNum=1">
              <label class="custom-control-label" for="Check2">{{"systemcode.eng" | translate }}</label>
            </div>
          </div>
          <div class="col-4 col-sm-3 col-md-2 col-lg-2">
            <input [(ngModel)]="engNum" type="number" min="1" max="30" class="form-control " [disabled]="!engCheckbox"
              (change)="!engNum?engNum=1:(engNum>30?engNum=30:engNum)">
          </div>
          <div class="col-2 col-sm-2 col-md-2 col-lg-1">
            <label class=" control-label col-form-label">{{"pwf001.copy" | translate}}</label>
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-md-12 col-xs-12 b-r">
            <small class="text-muted">{{"Note"| translate}}</small>
            <h6>{{"systemcode.pwf.001.note" | translate}}</h6>
          </div>
          <app-workflow-remark [wfid]="wfid"></app-workflow-remark>
        </div>
      </div>
    </div>
  </div>
  <!-- เหตุผล -->
  <div class="col-12">
    <div class="card mb-0">
      <div class="card-header bg-myhr">
        <h6 class="card-title">{{"systemcode.note" | translate}}</h6>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-12 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"systemcode.note"| translate}}</small>
              <textarea class="form-control" rows="2" style="resize: none;" [(ngModel)]="remark"
                placeholder='{{"systemcode.note"| translate}}'></textarea>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- เอกสารอ้างอิง -->
  <div class="col-12" *ngIf="runno&&workflowData">
    <div class="card mb-0">
      <div class="card-header bg-myhr">
        <h6 class="card-title">{{"Doc Reference" | translate}}</h6>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <h6 class="cursor-myhr" (click)="openDocReference()">
                {{translateService.currentLang=="th"?workflowData.thaiSubject:workflowData.engSubject}}
                [{{workflowData.doc_no}}]
              </h6>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- แนบไฟล์ -->
  <div class="col-12">
    <div class="card mb-0">
      <div class="card-header bg-myhr">
        <h6 class="card-title">{{"attach_file" | translate}}</h6>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"selected_file"| translate}}</small>
              <div class="input-group">
                <div class="input-group-prepend">
                  <span class="input-group-text">{{"upload_file"|translate}}</span>
                </div>
                <div class="custom-file">
                  <input #fileInput type="file" class="custom-file-input" id="inputGroupFile01" title=""
                    (change)="onFileSelected($event)"
                    accept="{{uploadConfig?uploadConfig.filter.replaceAll('*',''):''}}">
                  <label class="custom-file-label col-lg-12 col-md-12 col-sm-12" for="inputGroupFile01">{{nameFile |
                    translate}}</label>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group " style="margin-top: 20px;">
              <button type="button" class="btn btn-danger" (click)="resetIMG()">{{"cancel"| translate}}</button>
            </div>
          </div>
          <div class="col-md-12 col-xs-12 b-r" *ngIf="uploadConfig">
            <p class="text-danger m-b-0">{{"Maximum upload size" | translate}} {{uploadConfig.maxSize/1024/1024}} MB</p>
            <p class="text-danger">{{"Extensions are support" | translate}} {{uploadConfig.filter}}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="card-body ">
    <div class="d-flex no-block align-items-center justify-content-center">
      <div class="action-form">
        <div class="form-group m-b-0 text-center">
          <button [disabled]="!certificateTemplateSelect.certType||(!thaiCheckbox&&!engCheckbox)" type="submit"
            class="btn btn-success waves-effect waves-light" (click)="onSubmit()"><i class=" fas fa-check"></i>
            {{"Submit" | translate}}</button>

        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal ประเภทหนังสือรับรอง -->
<ng-template #certificateModal let-modal>
  <div class="modal-content dialog-height">
    <div class="modal-body" [perfectScrollbar]="config">
      <div class="card" style="margin-bottom:-15px">
        <div class="card-header bg-myhr">
          <h5 class="card-title">{{"pwf001.certificate.type" | translate}}</h5>
        </div>
        <div class="card-body pb-0 pt-1">
          <div class="d-flex mb-1">
            <input type="text" placeholder="{{'pwf001.certificate.type' | translate}}" class="form-control w-50"
              [(ngModel)]="certificateTemplateSearch" (ngModelChange)="searchData()">
          </div>
          <div class="table-responsive">
            <div class="wrapper">
              <table class="table  table-hover table-striped-myhr table-sm  mb-0 no-wrap v-middle">
                <thead class="bg-info ">
                  <tr class="text-white font-weight-normal">
                    <th class="font-weight-normal text-center" scope="col">{{"pwf001.certificate.type" | translate}}
                    </th>
                    <th class="font-weight-normal text-center" scope="col">{{"systemcode.doctype.name.th" |
                      translate}}</th>
                    <th class="font-weight-normal text-center" scope="col">{{"systemcode.doctype.name.eng"|
                      translate}}</th>
                    <th class="font-weight-normal text-center" scope="col"></th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngIf="certificateTemplateFilter.length == 0">
                    <td colspan="100%" class="font-weight-normal text-center">
                      {{"No Data Found" | translate}}
                    </td>
                  </tr>
                  <tr
                    *ngFor="let item of certificateTemplateFilter |slice: (page-1) * pageSize : (page-1) * pageSize + pageSize; let i=index">
                    <td class="font-weight-normal text-center">{{item.certType}}</td>
                    <td class="font-weight-normal text-center">{{item.tdesc}}</td>
                    <td class="font-weight-normal text-center">{{item.edesc}}</td>
                    <td class="font-weight-normal text-center"><button type="button" class="btn btn-info btn-sm"
                        style="width: 60px;" (click)="modal.close(item)">
                        {{"choose"| translate}}
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="d-flex justify-content-end p-2">

            <select class="form-select m-r-5" style="width: auto" [(ngModel)]="pageSize" (ngModelChange)="page=1">
              <option [ngValue]="10">{{"Items per page" | translate}}: 10</option>
              <option [ngValue]="50">{{"Items per page" | translate}}: 50</option>
              <option [ngValue]="100">{{"Items per page" | translate}}: 100</option>
            </select>
            <ngb-pagination [collectionSize]="certificateTemplateFilter.length" [(page)]="page" [pageSize]="pageSize"
              [maxSize]="3" [rotate]="true">
              <ng-template ngbPaginationPrevious>{{"Prev" | translate}}</ng-template>
              <ng-template ngbPaginationNext>{{"Next" | translate}}</ng-template>
            </ngb-pagination>

          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-danger" (click)="modal.dismiss()">{{"Close" |
        translate}}</button>
    </div>
  </div>
</ng-template>
