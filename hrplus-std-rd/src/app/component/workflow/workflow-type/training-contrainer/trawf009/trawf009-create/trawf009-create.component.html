<!-- ใบขออนุมัติฝึกอบรมและสัมมนาภายใน -->
<div class="row">
  <!-- ส่งถึง -->
  <div class="col-12">
        <app-workflow-sendto (employeeCCId)="employeeCCId=$event" [wfid]="wfid" cardName="systemcode.train.in.approve"></app-workflow-sendto>
    </div>

  <!-- รายละเอียดข้อมูลพนักงาน -->
  <div class="col-12">
    <div class="card mb-0">
      <div class="card-header bg-myhr">
        <h6 class="card-title">{{"Employee Detail" | translate}}</h6>
      </div>
      <div class="card-body" *ngIf="emp">
        <div class="row">
          <div class="col-md-6 col-xs-12 b-r">
            <small class="text-muted">{{"Employee ID" | translate}}</small>
            <h6>{{emp.employeeId}}</h6>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <small class="text-muted">{{"Name-Surname" | translate}}</small>
            <h6>{{emp.getFullname()}}</h6>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <small class="text-muted">{{"Position" | translate}}</small>
            <h6>{{emp.position.getPositionDesc()?emp.position.getPositionDesc():'-'}}</h6>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <small class="text-muted">{{"dashboard.bu1" | translate}}</small>
            <h6>{{emp.bu1.getBu1Desc()?emp.bu1.getBu1Desc():'-'}}</h6>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <small class="text-muted">{{"dashboard.bu2" | translate}}</small>
            <h6>{{emp.bu2.getBu2Desc()?emp.bu2.getBu2Desc():'-'}}</h6>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <small class="text-muted">{{"dashboard.bu3" | translate}}</small>
            <h6>{{emp.bu3.getBu3Desc()?emp.bu3.getBu3Desc():'-'}}</h6>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <small class="text-muted">{{"dashboard.bu4" | translate}}</small>
            <h6>{{emp.bu4.getBu4Desc()?emp.bu4.getBu4Desc():'-'}}</h6>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <small class="text-muted">{{"dashboard.bu5" | translate}}</small>
            <h6>{{emp.bu5.getBu5Desc()?emp.bu5.getBu5Desc():'-'}}</h6>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <small class="text-muted">{{"tel" | translate}}</small>
            <h6>{{emp.telExt?emp.telExt:'-'}}</h6>
          </div>
        </div>
      </div>
    </div>
  </div>


  <!-- รายละเอียดการอบรม -->
  <div class="col-12">
    <div class="card mb-0">
      <div class="card-header bg-myhr">
        <h6 class="card-title">{{"training detail" | translate}}</h6>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"training id"| translate }}</small>
              <div class="input-group mb-3">
                <input type="text" class="form-control col-md-8 col-sm-8 col-lg-8" placeholder=""
                  [(ngModel)]="trainInSelectId" (ngModelChange)="trainingIdChange(trainInSelectId)">
                <div class="input-group-append">
                  <button class="btn me-0 btn-info" type="button" (click)="openModal(contentCourse,'Course')"><i
                      class="fa fa-search"></i></button>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"systemcode.train.desc" | translate}}</small>
              <input type="text" class="form-control col-lg-8 col-md-8 col-sm-8 " disabled
                value="{{trainInSelect.title}}">
            </div>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"systemcode.course.desc" | translate}}</small>
              <input type="text" class="form-control col-lg-8 col-md-8 col-sm-8 " disabled
                value="{{trainInSelect.course?trainInSelect.course.getCourseDesc():''}}">
            </div>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"systemcode.location" | translate}}</small>
              <input type="text" class="form-control col-lg-8 col-md-8 col-sm-8 " disabled
                value="{{trainInSelect.location?trainInSelect.location.getLocationDesc():''}}">
            </div>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"systemcode.course.start.date" | translate}}</small>
              <input type="text" class="form-control col-lg-6 col-md-6 col-sm-6 " disabled
                value="{{trainInSelect.classDateFrm?trainInSelect.classDateFrm.split('-').reverse().join('-'):''}}">
            </div>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"systemcode.course.end.date" | translate}}</small>
              <input type="text" class="form-control col-lg-6 col-md-6 col-sm-6 " disabled
                value="{{trainInSelect.classDateTo?trainInSelect.classDateTo.split('-').reverse().join('-'):''}}">
            </div>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"systemcode.start.time" | translate}}</small>
              <input type="text" class="form-control col-lg-6 col-md-6 col-sm-6 " disabled
                value="{{trainInSelect.timeStart?trainInSelect.timeStart+'.00':''}}">
            </div>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"systemcode.end.time" | translate}}</small>
              <input type="text" class="form-control col-lg-6 col-md-6 col-sm-6 " disabled
                value="{{trainInSelect.timeStop?trainInSelect.timeStop+'.00':''}}">
            </div>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"systemcode.cost.plan" | translate}} : {{"systemcode.bth" |
                translate}}</small>
              <input type="text" class="form-control col-lg-6 col-md-6 col-sm-6 " disabled
                value="{{calculate('estimate')|number:'2.2'}}">
            </div>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"systemcode.actual.cost" | translate}} : {{"systemcode.bth" |
                translate}}</small>
              <input type="text" class="form-control col-lg-6 col-md-6 col-sm-6" disabled
                value="{{calculate('used')|number:'2.2'}}">
            </div>
          </div>
          <div class="col-12 p-0">
            <app-workflow-remark [wfid]="wfid"></app-workflow-remark>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-12" *ngIf="trainCost&&trainCost.length!=0">
    <div class="card mb-0 ">
      <div class="card-header bg-myhr">
        <h6 class="card-title">{{ "training.cost.detail" | translate }}</h6>
      </div>
      <div class="card-body pe-0 ps-0 pb-0">
        <div class="table-responsive">
          <div class="wrapper">
            <table class="table  table-hover table-striped-myhr table-sm  mb-0 no-wrap v-middle ">
              <thead class="bg-info ">
                <tr class="text-white font-weight-normal">
                  <th class="font-weight-normal text-center" scope="col">{{"No." | translate }}</th>
                  <th class="font-weight-normal " scope="col">{{"systemcode.cost.id" | translate }}</th>
                  <th class="font-weight-normal " scope="col">{{"systemcode.cost.desc" | translate }}</th>
                  <th class="font-weight-normal " scope="col">{{"systemcode.cost.group" | translate }}</th>
                  <th class="font-weight-normal " scope="col">{{"systemcode.cost.per.person" | translate }}</th>
                  <th class="font-weight-normal " scope="col">{{"systemcode.cost.plan" | translate }}</th>
                  <th class="font-weight-normal " scope="col">{{"systemcode.actual.cost" | translate }}</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let item of trainCost | slice: (pageTrainCost-1)*pageSizeTrainCost: (pageTrainCost-1)*pageSizeTrainCost+pageSizeTrainCost; ; let i=index">
                  <td class="align-middle text-center">{{i+1}}</td>
                  <td class="align-middle ">{{item.expense.expId}}</td>
                  <td class="align-middle ">{{item.expense.expDesc}}</td>
                  <td class="align-middle ">{{item.expGrp.expgrpDesc}}</td>
                  <td class="align-middle ">{{item.expensePerCapita|number:'2.2'}}</td>
                  <td class="align-middle ">{{item.estimate|number:'2.2'}}</td>
                  <td class="align-middle ">{{item.used|number:'2.2'}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="d-flex justify-content-end p-2">

          <select class="form-select m-r-5" style="width: auto" [(ngModel)]="pageSizeTrainCost"
            (ngModelChange)="pageTrainCost=1">
            <option [ngValue]="10">{{"Items per page"| translate }}: 10</option>
            <option [ngValue]="50">{{"Items per page"| translate }}: 50</option>
            <option [ngValue]="100">{{"Items per page"| translate }}: 100</option>
          </select>
          <ngb-pagination [collectionSize]="collectionSizeTrainCost" [(page)]="pageTrainCost"
            [pageSize]="pageSizeTrainCost" [maxSize]="3" [rotate]="true">
            <ng-template ngbPaginationPrevious>{{"Prev"| translate }}</ng-template>
            <ng-template ngbPaginationNext>{{"Next"| translate }}</ng-template>
          </ngb-pagination>

        </div>
      </div>
    </div>
  </div>
  <div class="col-12" *ngIf="courseEmp">
    <div class="card mb-0 ">
      <div class="card-header bg-myhr">
        <h6 class="card-title">{{ "training.emp" | translate }}</h6>
      </div>
      <div class="card-body pe-0 ps-0 pb-0">
        <div class="table-responsive">
          <div class="wrapper">
            <table class="table  table-hover table-striped-myhr table-sm  mb-0 no-wrap v-middle ">
              <thead class="bg-info ">
                <tr class="text-white font-weight-normal">
                  <th class="font-weight-normal text-center" scope="col">{{"No." | translate }}</th>
                  <th class="font-weight-normal" scope="col">{{"systemcode.emp.id" | translate }}</th>
                  <th class="font-weight-normal" scope="col">{{"systemcode.emp.name" | translate }}</th>
                  <th class="font-weight-normal" scope="col">{{"systemcode.position" | translate }}</th>
                  <th class="font-weight-normal" scope="col">{{"systemcode.bu1" | translate }}</th>
                  <th class="font-weight-normal" scope="col">{{"systemcode.bu2" | translate }}</th>
                  <th class="font-weight-normal" scope="col">{{"systemcode.bu3" | translate }}</th>
                  <th class="font-weight-normal" scope="col">{{"systemcode.costcenter" | translate }}</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let item of courseEmp | slice: (pageCourseEmp-1)*pageSizeCourseEmp: (pageCourseEmp-1)*pageSizeCourseEmp+pageSizeCourseEmp;; let i=index">
                  <td class="align-middle text-center">{{(pageCourseEmp-1)*pageSizeCourseEmp+(i+1)}}</td>
                  <td class="align-middle ">{{item.employeeId}}</td>
                  <td class="align-middle ">{{item.getFullname()}}</td>
                  <td class="align-middle ">{{item.position?item.position.getPositionDesc():''}}</td>
                  <td class="align-middle ">{{item.bu1?item.bu1.getBu1Desc():''}}</td>
                  <td class="align-middle ">{{item.bu2?item.bu2.getBu2Desc():''}}</td>
                  <td class="align-middle ">{{item.bu3?item.bu3.getBu3Desc():''}}</td>
                  <td class="align-middle ">{{item.costcenter?item.costcenter.getCostcenterDesc():''}}</td>
                </tr>

              </tbody>
            </table>
          </div>
        </div>

        <div class="d-flex justify-content-end p-2">

          <select class="form-select m-r-5" style="width: auto" [(ngModel)]="pageSizeCourseEmp"
            (ngModelChange)="pageCourseEmp=1">
            <option [ngValue]="10">{{"Items per page"| translate }}: 10</option>
            <option [ngValue]="50">{{"Items per page"| translate }}: 50</option>
            <option [ngValue]="100">{{"Items per page"| translate }}: 100</option>
          </select>
          <ngb-pagination [collectionSize]="collectionSizeCourseEmp" [(page)]="pageCourseEmp"
            [pageSize]="pageSizeCourseEmp" [maxSize]="3" [rotate]="true">
            <ng-template ngbPaginationPrevious>{{"Prev"| translate }}</ng-template>
            <ng-template ngbPaginationNext>{{"Next"| translate }}</ng-template>
          </ngb-pagination>

        </div>
      </div>
    </div>
  </div>















  <!-- เหตุผล -->
  <div class="col-12">
    <div class="card mb-0">
      <div class="card-header bg-myhr">
        <h6 class="card-title">{{"systemcode.note" | translate}}</h6>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-12 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"systemcode.note"| translate}}</small>
              <textarea class="form-control" rows="2" style="resize: none;" [(ngModel)]="remark"
                placeholder='{{"systemcode.note"| translate}}'></textarea>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- เอกสารอ้างอิง -->
  <div class="col-12" *ngIf="runno&&workflowData">
    <div class="card mb-0">
      <div class="card-header bg-myhr">
        <h6 class="card-title">{{"Doc Reference" | translate}}</h6>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <h6 class="cursor-myhr" (click)="openDocReference()">
                {{translateService.currentLang=="th"?workflowData.thaiSubject:workflowData.engSubject}}
                [{{workflowData.doc_no}}]
              </h6>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- แนบไฟล์ -->
  <div class="col-12">
    <div class="card mb-0">
      <div class="card-header bg-myhr">
        <h6 class="card-title">{{"attach_file" | translate}}</h6>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group">
              <small class="text-muted">{{"selected_file"| translate}}</small>
              <div class="input-group">
                <div class="input-group-prepend">
                  <span class="input-group-text">{{"upload_file"|translate}}</span>
                </div>
                <div class="custom-file">
                  <input #fileInput type="file" class="custom-file-input" id="inputGroupFile01" title=""
                    (change)="onFileSelected($event)"
                    accept="{{uploadConfig?uploadConfig.filter.replaceAll('*',''):''}}">
                  <label class="custom-file-label col-lg-12 col-md-12 col-sm-12" for="inputGroupFile01">{{nameFile |
                    translate}}</label>
                </div>


              </div>
            </div>
          </div>
          <div class="col-md-6 col-xs-12 b-r">
            <div class="form-group " style="margin-top: 20px;">
              <button type="button" class="btn btn-danger" (click)="resetIMG()">{{"cancel"| translate}}</button>
            </div>
          </div>
          <div class="col-md-12 col-xs-12 b-r" *ngIf="uploadConfig">
            <p class="text-danger m-b-0">{{"Maximum upload size" | translate}} {{uploadConfig.maxSize/1024/1024}} MB</p>
            <p class="text-danger">{{"Extensions are support" | translate}} {{uploadConfig.filter}}</p>
          </div>

        </div>
      </div>
    </div>


    <div class="card-body ">
      <div class="d-flex no-block align-items-center justify-content-center">
        <div class="action-form">
          <div class="form-group m-b-0 text-center">
            <button [disabled]="!trainInSelect.title" type="submit" class="btn btn-success waves-effect waves-light"
              (click)="openConfirmModal('submit')"><i class=" fas fa-check"></i>
              {{"Submit" | translate}}</button>

          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Row ปิดใบขออนุมัติฝึกอบรมและสัมมนาภายใน -->


  <!-- คอร์สฝึกอบรม -->
  <ng-template #contentCourse let-modal>
    <div class="modal-content">
      <div class="modal-body" [perfectScrollbar]="config">

        <div class="card" style="margin-bottom:-15px">
          <div class="card-header bg-myhr">
            <h4>{{"trainig.course" | translate}}</h4>
          </div>
          <div class="card-body pt-0 pt-2">
            <div class="d-flex mb-1">
              <input type="text" placeholder="{{'systemcode.search' | translate}} {{'training id' | translate}}"
                class="form-control w-50" [(ngModel)]="searchTrainIn" (ngModelChange)="searchTrainInChange()">
            </div>
            <div class="table-responsive">
              <table class="table  table-hover table-striped-myhr table-sm  mb-0 no-wrap v-middle ">
                <thead class="bg-info ">
                  <tr class="text-white font-weight-normal">
                    <th class="font-weight-normal" scope="col">{{"training id"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"desc"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"course.id"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"book.date"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"book.to.date"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"class.start.date"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"class.end.date"| translate}}</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngIf="!trainInShow||trainInShow?.length==0">
                    <td colspan="100%" class="font-weight-normal text-center">{{"No Data Found" | translate}}</td>
                  </tr>
                  <tr class="cursor-myhr"
                    *ngFor="let item of trainInShow | slice: (pageModal-1)*pageSizeModal: (pageModal-1)*pageSizeModal+pageSizeModal; let i=index"
                    (click)="selectTrainIn(item);modal.close('Close click')">
                    <th class="align-middle" scope="row">{{item.trainingId}}</th>
                    <td class="align-middle">{{item.title}}</td>
                    <td class="align-middle">{{item.course.courseId}}</td>
                    <td class="align-middle">{{item.resDateFrm.split("-").reverse().join("-")}}</td>
                    <td class="align-middle">{{item.resDateTo.split("-").reverse().join("-")}}</td>
                    <td class="align-middle">{{item.classDateFrm.split("-").reverse().join("-")}}</td>
                    <td class="align-middle">{{item.classDateTo.split("-").reverse().join("-")}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="d-flex justify-content-end p-2">
              <select class="form-select m-r-5" style="width: auto" [(ngModel)]="pageSizeModal"
                (ngModelChange)="pageModal=1">
                <option [ngValue]="10">{{"Items per page" | translate}}: 10</option>
                <option [ngValue]="50">{{"Items per page" | translate}}: 50</option>
                <option [ngValue]="100">{{"Items per page" | translate}}: 100</option>
              </select>
              <ngb-pagination [collectionSize]="collectionSizeModal" [(page)]="pageModal" [pageSize]="pageSizeModal"
                [maxSize]="3" [rotate]="true">
                <ng-template ngbPaginationPrevious>{{"Prev" | translate}}</ng-template>
                <ng-template ngbPaginationNext>{{"Next" | translate}}</ng-template>
              </ngb-pagination>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" (click)="modal.dismiss('Cross click')">{{"Close"|
          translate}}</button>
      </div>
    </div>
  </ng-template>

  <!-- แจ้งเตือน -->
  <ng-template #alertModal let-modal>
    <div class="modal-header">
      <h5 class="modal-title" id="editLabel">Alert Message</h5>
      <button type="button" class="close" (click)="modal.dismiss('Cross click')" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      {{msg}}
    </div>
  </ng-template>

  <ng-template #DocReferenceModal let-modal>
    <div class="modal-content dialog-height">
      <div class="modal-header">
        <h5 class="modal-title" id="editLabel">{{"systemcode.documents.detail" | translate}}</h5>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" [perfectScrollbar]="config">
        <div class="card" style="margin-bottom:-15px">
          <div class="card-body">
            <!-- ใส่เอกสารตรงนี้นะจ๊ะ -->
            <ng-template #workflowView [ngComponentOutlet]="dynamicComponent" [ndcDynamicInputs]="inputs"
              [ndcDynamicOutputs]="outputs"></ng-template>
            <!-- <app-wel210-nstda-create></app-wel210-nstda-create> -->
          </div>
        </div>
        <div class="d-flex no-block align-items-center justify-content-center mt-4">
          <div class="action-form">
            <div class="form-group m-b-0 text-center">
              <button type="button" class="btn btn-danger" (click)="openConfirmModal('cancel')"><i
                  class=" fas fa-times"></i>
                {{"cancel" |translate}}</button>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-info" (click)="closeBtnClick()">{{"confirm"| translate}}</button>
      </div>
    </div>
  </ng-template>
