<div class="card">
    <div class="card-header bg-myhr" >
      <h4>{{"Set Dayoff" | translate}}</h4>
    </div>
    <div class="card-body " >
          <!-- <form novalidate="" class="form-horizontal ">
            <div class="row g-2 align-middle">
              <div class="form-group col-md-3 col-5 col-sm-5 offset-md-2" style="margin-top: 5px;"> 
                <input readonly type="text" class="form-control " placeholder="{{'Employee ID'| translate}}" value="{{empId}}"
                aria-describedby="basic-addon1" >
              </div>
              <div class="form-group col-md-3 col-5 col-sm-5" style="margin-top: 5px;">
                <input readonly type="text" class="form-control"  placeholder="{{'Name-Surname'| translate}}"  id="inputCity" value="{{translateService.currentLang=='th'?TempHrSelectName:EempHrSelectName}}">
              </div>
              <div class="form-group col-md-2 col-2 col-sm-2 " style="text-align: left;margin-top: 5px;">
                <button type="button" class="btn btn-info  btn-sm btn-circle  m-r-5 m-l-10" (click)="openModalEmp(contentEmp)"><i
                    class="fa fa-search"></i> </button>
              </div>
              <div class="form-group col-md-2" style="margin-top: 5px; text-align: right;">
              </div>
            </div>
          </form> -->
          <div class="row g-2 align-middle">
            <div class="offset-md-2 col-md-3 col-5 col-sm-5 ">
              <div class="form-group">
                <div class="input-group mb-3">
                  <input type="text" class="form-control"  placeholder="{{'Employee ID'| translate}}" value="{{empId}}" aria-describedby="basic-addon1">
                  <div class="input-group-append">
                    <button class="btn me-0 btn-info" type="button"(click)="openModalEmp(contentEmp);" ><i
                        class="fa fa-search"></i></button>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-3 col-5 col-sm-5">
              <div class="form-group">
                <input type="text" value="{{translateService.currentLang=='th'?TempHrSelectName:EempHrSelectName}}"  placeholder="{{'Name-Surname'| translate}}" class="form-control"disabled>
              </div>
            </div>
          </div>
          <!-- ค้นหาเดือน/ปี -->
       <!-- ค้นหาเดือน/ปี -->
        <!-- start -->
        <div class="row g-2 align-middle">
          <div class="form-group offset-md-2 col-md-3 col-5 col-sm-5" style="margin-top: 5px;">
            <div class="form-group">
              <div class="input-group">
                <div class="input-group-prepend">
                  <span class="input-group-text" id="basic-addon13">
                    {{"Start Date" | translate}}
                  </span>
                </div>
                <input class="form-control"
                placeholder="{{'dd.mm.yyyy' | translate}}" name="dp1" 
                [(ngModel)]="firstDay" ngbDatepicker #d1="ngbDatepicker"
                [maxDate]="lastDay" #ngb1="ngModel"
                (change)="firstDay = datepickerService.validateFormatDateNull(ngb1)">
                <!-- (ngModelChange)="changeDateCheck('firstDay')"> -->
                <div class="input-group-append">
                  <button class="btn btn-outline-info no-shadow" (click)="d1.toggle()" type="button">
                    <i class="far fa-calendar-alt"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- end -->
          <div class="form-group col-md-3 col-5 col-sm-5" style="margin-top: 5px;">
            <div class="form-group">
              <div class="input-group">
                <div class="input-group-prepend">
                  <span class="input-group-text" id="basic-addon13">
                    {{"End Date" | translate}}
                  </span>
                </div>
                <input class="form-control"
                placeholder="{{'dd.mm.yyyy' | translate}}" name="dp2"  
                [(ngModel)]="lastDay" ngbDatepicker #d2="ngbDatepicker"
                [minDate]="firstDay" #ngd2="ngModel"
                (change)="lastDay = datepickerService.validateFormatDateNull(ngd2)">
                <!-- (ngModelChange)="changeDateCheck('lastDay')"> -->
                <div class="input-group-append">
                  <button class="btn btn-outline-info no-shadow" (click)="d2.toggle()" type="button">
                    <i class="far fa-calendar-alt"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="form-group col-md-2 col-2 col-sm-2" style="text-align: left;margin-top: 5px;">
            <button type="button" class="btn btn-info  btn-sm btn-circle  m-r-5 m-l-10" (click)="getSetdayoff()"><i
                class="fa fa-search"></i> </button>
          </div>
          <div class="form-group col-md-2" style="margin-top: 5px; text-align: right;">
  
          </div>
        </div>


<div class="table-responsive">
    <div class="wrapper">
        <table class="table  table-sm  mb-0 no-wrap v-middle ">
            <thead class="bg-info " >
            <tr class="text-white font-weight-normal">
              <th class="font-weight-normal width-table text-center " scope="col">{{"date" | translate}}</th>
              <th class="font-weight-normal width-table text-center" scope="col">{{"day"| translate}}</th>
              <th class="font-weight-normal width-table text-center" scope="col">{{"working.time"| translate}}</th>
              <th class="font-weight-normal width-table text-center" scope="col">{{"Punch Time"| translate}}</th>
              <th class="font-weight-normal width-table text-center" scope="col">{{"Day Type"| translate}}</th>
              <th class="font-weight-normal width-table text-center" scope="col">{{"systemcode.dayoff"| translate}}</th>
            </tr>
            </thead>
            <tbody *ngIf="loading">
              <tr >
                <td colspan="6" class="font-weight-normal text-center">
                  <div class="justify-content-center text-center" role="status" >
                    <div class="spinner-grow text-info" role="status" style="margin: 5px;">
                      <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow text-info" role="status" style="margin: 5px;">
                      <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow text-info" role="status" style="margin: 5px;">
                      <span class="sr-only">Loading...</span>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
            <tbody *ngIf="!loading">
              <tr *ngFor="let item of getDayoff;let i = index;">
                <td class=" align-middle text-center "><span [ngClass]="{  'text-info': item.trType === 'HD','text-danger' : item.trType ==='H0' ,'text-success': item.trType === 'I0' }">{{item.dateId}}</span></td>
                <td class=" align-middle text-center "><span [ngClass]="{  'text-info': item.trType === 'HD','text-danger' : item.trType ==='H0' ,'text-success': item.trType === 'I0' }">{{translateService.currentLang == 'th'? ((item.dateId.split('-')[2]+'-'+item.dateId.split('-')[1]+"-"+item.dateId.split('-')[0])| thaidate : "day"): ((item.dateId.split('-')[2]+'-'+item.dateId.split('-')[1]+"-"+item.dateId.split('-')[0]) | date:'EEEE')}}</span></td>
                <td class=" align-middle text-center "><span [ngClass]="{  'text-info': item.trType === 'HD','text-danger' : item.trType ==='H0' ,'text-success': item.trType === 'I0' }">{{item.startDate}} {{item.startTime | number : '.2' }} - {{item.endDate}} {{item.endTime | number: '.2'}}</span></td>
                <td class=" align-middle text-center "><span [ngClass]="{  'text-info': item.trType === 'HD','text-danger' : item.trType ==='H0' ,'text-success': item.trType === 'I0' }"> {{item.swipeTime}}</span></td>
                <td class=" align-middle text-center "><span [ngClass]="{  'text-info': item.trType === 'HD','text-danger' : item.trType ==='H0' ,'text-success': item.trType === 'I0' }"> {{item.eventgrp.getDesc()}}</span>
                </td>
                <td class=" align-middle text-center ">
                    <input type="checkbox"  class="form-control-input" (click)="openOnSubmit(item,$event.target.checked)" [checked]="item.eventgrp.eventgrpId ==='H' || item.eventgrp.eventgrpId === 'I'" >
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        </div>
    </div>
</div>
<!-- รายชื่อพนักงาน -->
<ng-template #contentEmp let-modal>
    <div class="modal-content dialog-height">
      <div class="modal-body" [perfectScrollbar]="config">
        <div class="card" style="margin-bottom:-15px">
          <div class="card-header bg-myhr">
            <h4>{{"subordinate list" | translate}}</h4>
          </div>
          <div class="card-body pt-0 pt-2">
            <div class="d-flex mb-1">
              <input type="text" placeholder="{{'Name-Surname' | translate}}" class="form-control w-25"
                [(ngModel)]='searchTerm'>
            </div>
            <div class="table-responsive">
              <table class="table  table-hover table-striped-myhr table-sm  mb-0 no-wrap v-middle ">
                <thead class="bg-info ">
                  <tr class="text-white font-weight-normal">
                    <th class="font-weight-normal" scope="col">{{"No."| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"Employee ID"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"Name-Surname"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"Position"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"Bu1"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"Bu2"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"Bu3"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"Bu4"| translate}}</th>
                    <th class="font-weight-normal" scope="col">{{"Bu5"| translate}}</th>
                  </tr>
                </thead>
                <tbody *ngIf="loading">
                  <tr>
                    <td colspan="9" class="font-weight-normal text-center">
                      <div class="justify-content-center text-center" role="status">
                        <div class="spinner-grow text-info" role="status" style="margin: 5px;">
                          <span class="sr-only">Loading...</span>
                        </div>
                        <div class="spinner-grow text-info" role="status" style="margin: 5px;">
                          <span class="sr-only">Loading...</span>
                        </div>
                        <div class="spinner-grow text-info" role="status" style="margin: 5px;">
                          <span class="sr-only">Loading...</span>
                        </div>
                      </div>
                    </td>
                  </tr>
                </tbody>
                <tbody *ngIf="!loading">
                  <tr *ngIf="noData">
                    <td colspan="9" class="font-weight-normal text-center">{{"No Data Found" | translate}}</td>
                  </tr>
                  <tr class="cursor-myhr"
                    *ngFor="let item of empHrShow | slice: (page-1) * pageSize : (page-1) * pageSize + pageSize; let i=index"
                    (click)="selectEmp(item.employeeId);modal.dismiss('Cross click');">
                    <th class="align-middle text-center" scope="row">{{i+((page-1)*pageSize)+1}}</th>
                    <td class="align-middle">{{item.employeeId}}</td>
                    <td class="align-middle">{{item.getFullname()}}</td>
                    <td class="align-middle">{{item.position.getPositionDesc()?item.position.getPositionDesc():'-'}}
                    </td>
                    <td class="align-middle">{{item.bu1.getBu1Desc()?item.bu1.getBu1Desc():'-'}}</td>
                    <td class="align-middle">{{item.bu2.getBu2Desc()?item.bu2.getBu2Desc():'-'}}</td>
                    <td class="align-middle">{{item.bu3.getBu3Desc()?item.bu3.getBu3Desc():'-'}}</td>
                    <td class="align-middle">{{item.bu4.getBu4Desc()?item.bu4.getBu4Desc():'-'}}</td>
                    <td class="align-middle">{{item.bu5.getBu5Desc()?item.bu5.getBu5Desc():'-'}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="d-flex justify-content-end p-2">
              <select class="form-select m-r-5" style="width: auto" [(ngModel)]="pageSize" (ngModelChange)="page=1">
                <option [ngValue]="10">{{"Items per page"| translate}}: 10</option>
                <option [ngValue]="50">{{"Items per page"| translate}}: 50</option>
                <option [ngValue]="100">{{"Items per page"| translate}}: 100</option>
              </select>
              <ngb-pagination [collectionSize]="collectionSize" [(page)]="page" [pageSize]="pageSize" [maxSize]="3"
                [rotate]="true">
                <ng-template ngbPaginationPrevious>{{"Prev"| translate}}</ng-template>
                <ng-template ngbPaginationNext>{{"Next"| translate}}</ng-template>
              </ngb-pagination>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" (click)="modal.dismiss('Cross click')">{{"Close"|
          translate}}</button>
      </div>
    </div>
  </ng-template>


<ng-template #alertModal let-modal>
  <div class="modal-header">
      <h5 class="modal-title" id="editLabel">Alert Message</h5>
      <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
          <span aria-hidden="true">&times;</span>
      </button>
  </div>
  <div class="modal-body">
    {{msg}}
  </div>
</ng-template>
<ng-template #confirmModal let-modal>
    <div class="modal-header">
      <h5 class="modal-title" id="editLabel">{{"Alert Message" | translate}}</h5>
      <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      {{msg | translate}}
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-info" (click)="checkDay();modal.close('Close click')">{{"confirm"|
        translate}}</button> <button type="button" class="btn btn-danger" (click)="this.modalService.dismissAll();getSetdayoff();">{{"cancel"|
        translate}}</button>
    </div>
  </ng-template>
